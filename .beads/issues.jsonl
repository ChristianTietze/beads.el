{"id":"bdel-04e","title":"Implement close issue command","description":"Add functionality to close issues from within beads.el. Currently shows \"Close issue not yet implemented\" message in beads-transient.el.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T14:11:19.180412+01:00","updated_at":"2025-12-17T14:39:19.659398+01:00","closed_at":"2025-12-17T14:39:19.659398+01:00","close_reason":"Implemented: works from list and detail view, prompts for optional reason"}
{"id":"bdel-0e9","title":"Auto-refresh beads list in background","description":"Auto-refresh the beads list buffer periodically in the background, preserving the current selection.\n\nRequirements:\n1. Remember which issue is selected (by ID) before refresh\n2. Create `beads-list-goto-id` function to move point to line with specific ID\n3. After refresh, restore selection to the same issue ID\n4. New `beads-autoupdate.el` module for timer management\n5. Buffer-local `beads-autoupdate-message` variable (t by default)\n6. Support dir-local settings to reduce noise in busy projects\n\nUser experience:\n- List updates automatically while browsing\n- Selection stays on the same issue even if list order changes\n- Optional: show \"Refreshed N issues\" message (can disable)\n- Graceful handling when selected issue no longer exists\n\nAcceptance criteria:\n- beads-list-goto-id finds issue by ID\n- Selection preserved after manual refresh (g)\n- Selection preserved after auto-refresh\n- Timer starts/stops with buffer lifecycle\n- Message can be disabled buffer-locally\n- Dir-locals work for message setting\n- Graceful when selected issue deleted","design":"Implementation plan:\n\n## 1. Add `beads-list-goto-id` function (beads-list.el)\n```elisp\n(defun beads-list-goto-id (id)\n  \"Move point to the line with issue ID, return t if found.\"\n  (goto-char (point-min))\n  (while (and (not (eobp))\n              (not (equal id (tabulated-list-get-id))))\n    (forward-line 1))\n  (not (eobp)))\n```\n\n## 2. Update `beads-list-refresh` to preserve selection\n- Before refresh: save `(tabulated-list-get-id)`\n- After refresh: call `beads-list-goto-id` with saved ID\n- If ID not found, stay at same line number or top\n\n## 3. Create `beads-autoupdate.el`\n```elisp\n(defcustom beads-autoupdate-interval 30\n  \"Seconds between auto-refresh. nil to disable.\"\n  :type '(choice (const :tag \"Disabled\" nil)\n                 (integer :tag \"Seconds\"))\n  :group 'beads)\n\n(defvar-local beads-autoupdate-message t\n  \"Whether to show message on auto-refresh.\nCan be set in .dir-locals.el to reduce noise.\")\n\n(defvar-local beads-autoupdate--timer nil\n  \"Timer for auto-refresh in this buffer.\")\n\n(defun beads-autoupdate-start ()\n  \"Start auto-refresh timer for current buffer.\")\n\n(defun beads-autoupdate-stop ()\n  \"Stop auto-refresh timer for current buffer.\")\n\n(define-minor-mode beads-autoupdate-mode\n  \"Minor mode for auto-refreshing beads list buffers.\")\n```\n\n## 4. Hook into beads-list-mode\n- Optionally enable autoupdate-mode by default\n- Or provide `beads-list-autoupdate` customization\n\n## 5. Dir-local support\n```elisp\n;; In .dir-locals.el:\n((beads-list-mode . ((beads-autoupdate-message . nil))))\n```","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T13:52:02.286575+01:00","updated_at":"2025-12-17T13:58:18.108909+01:00","closed_at":"2025-12-17T13:58:18.108909+01:00","close_reason":"Implemented: beads-list-goto-id, selection preservation in refresh, beads-autoupdate.el with timer management and dir-local support"}
{"id":"bdel-0kf","title":"Create beads-undo.el core module","description":"Create the core undo/redo module with:\n\n- `beads-undo-entry` cl-defstruct (issue-id, field, old-value, new-value, timestamp, description)\n- `beads-undo--stack` and `beads-undo--redo-stack` variables\n- `beads-undo-limit` customization (default 50)\n- `beads-undo-record` function to push entries\n- `beads-undo` command to undo last edit\n- `beads-redo` command to redo\n- `beads-undo-clear` command to clear history\n- Stack size enforcement (trim when over limit)\n\nDoes NOT include integration with edit commands yet.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T15:01:30.675454+01:00","updated_at":"2025-12-17T15:01:30.675454+01:00","dependencies":[{"issue_id":"bdel-0kf","depends_on_id":"bdel-dyk","type":"parent-child","created_at":"2025-12-17T15:01:45.682167+01:00","created_by":"daemon"}]}
{"id":"bdel-10j","title":"Implement dependency tree view using hierarchy.el","description":"Add a dependency tree visualization for issues using Emacs built-in hierarchy.el library. Display upstream (blockers) and downstream (dependents) in an interactive tree widget.","design":"## Overview\n\nUse Emacs built-in `hierarchy.el` (available since Emacs 28.1) to display issue dependencies as an interactive tree widget with expand/collapse functionality.\n\n## hierarchy.el API Reference\n\n### Core Functions\n\n```elisp\n(require 'hierarchy)\n\n;; Create empty hierarchy\n(hierarchy-new) → hierarchy object\n\n;; Add item with parent relationship\n(hierarchy-add-tree HIERARCHY ITEM PARENTFN \u0026optional CHILDRENFN ACCEPTFN)\n;; PARENTFN: (lambda (item) ...) → parent item or nil for roots\n;; Called recursively to build tree upward\n\n;; Query functions\n(hierarchy-roots HIERARCHY) → list of root items\n(hierarchy-children HIERARCHY ITEM) → direct children\n(hierarchy-length HIERARCHY) → total item count\n```\n\n### Display Functions\n\n```elisp\n;; Tree widget (expandable nodes) - PREFERRED for dependencies\n(hierarchy-tree-display HIERARCHY LABELFN \u0026optional BUFFER)\n\n;; Tabulated list format\n(hierarchy-tabulated-display HIERARCHY LABELFN \u0026optional BUFFER)\n\n;; LABELFN: (lambda (item indent) ...) inserts formatted text\n```\n\n### Label Helpers\n\n```elisp\n;; Add indentation based on depth\n(hierarchy-labelfn-indent LABELFN \u0026optional INDENT-STRING)\n\n;; Make items clickable buttons\n(hierarchy-labelfn-button LABELFN ACTIONFN)\n;; ACTIONFN: (lambda (item indent) ...) called on click\n```\n\n## Beads RPC Data Structures\n\n### From `beads-rpc-show`:\n```elisp\n;; Returns issue with dependency arrays:\n((dependencies . [\n   ((id . \"bdel-xxx\")\n    (title . \"Parent task\")\n    (status . \"open\")\n    (dependency_type . \"parent-child\"))  ; or \"blocks\", \"related\", \"discovered-from\"\n   ...])\n (dependents . [...])\n (dependency_count . 1)\n (dependent_count . 0))\n```\n\n### From `beads-rpc-dep-tree`:\n```elisp\n;; Returns flattened tree with depth info:\n[((id . \"bdel-root\")\n  (title . \"Root issue\")\n  (depth . 0)\n  (parent_id . \"bdel-root\")  ; self-ref for roots\n  (truncated . nil))\n ((id . \"bdel-child\")\n  (depth . 1)\n  (parent_id . \"bdel-root\")\n  ...)]\n```\n\n## Implementation Plan\n\n### New file: lisp/beads-hierarchy.el\n\n```elisp\n;;; beads-hierarchy.el --- Dependency tree view -*- lexical-binding: t -*-\n\n(require 'hierarchy)\n(require 'beads-rpc)\n\n(defgroup beads-hierarchy nil\n  \"Dependency tree display for Beads.\"\n  :group 'beads)\n\n(defface beads-hierarchy-status-open\n  '((t :inherit beads-list-status-open))\n  \"Face for open status in hierarchy.\")\n\n;; ... other faces\n\n(defvar-local beads-hierarchy--root-id nil\n  \"Root issue ID for current hierarchy buffer.\")\n\n(defvar beads-hierarchy-mode-map\n  (let ((map (make-sparse-keymap)))\n    (define-key map (kbd \"q\") #'quit-window)\n    (define-key map (kbd \"g\") #'beads-hierarchy-refresh)\n    (define-key map (kbd \"RET\") #'beads-hierarchy-goto-issue)\n    map))\n\n(define-derived-mode beads-hierarchy-mode special-mode \"Beads-Hierarchy\"\n  \"Mode for displaying issue dependency trees.\")\n```\n\n### Building the Hierarchy\n\n```elisp\n(defun beads-hierarchy--build (issue-id)\n  \"Build hierarchy for ISSUE-ID from dep_tree RPC.\"\n  (let* ((tree-data (beads-rpc-dep-tree issue-id))\n         (h (hierarchy-new))\n         (by-id (make-hash-table :test 'equal)))\n    \n    ;; Index issues by ID for parent lookup\n    (seq-doseq (issue tree-data)\n      (puthash (alist-get 'id issue) issue by-id))\n    \n    ;; Add each issue to hierarchy\n    (seq-doseq (issue tree-data)\n      (hierarchy-add-tree h issue\n        (lambda (i)\n          (let ((pid (alist-get 'parent_id i))\n                (id (alist-get 'id i)))\n            ;; Skip self-referential roots\n            (unless (equal pid id)\n              (gethash pid by-id))))))\n    h))\n```\n\n### Label Function\n\n```elisp\n(defun beads-hierarchy--labelfn (issue indent)\n  \"Insert formatted ISSUE at INDENT level.\"\n  (let ((id (alist-get 'id issue))\n        (title (alist-get 'title issue \"\"))\n        (status (alist-get 'status issue))\n        (type (alist-get 'issue_type issue)))\n    (insert (propertize id 'face 'beads-detail-id-face))\n    (insert \" \")\n    (insert (propertize \n             (truncate-string-to-width title 40 nil nil \"…\")\n             'face 'default))\n    (insert \" \")\n    (insert (propertize (format \"[%s]\" status)\n                        'face (beads-hierarchy--status-face status)))))\n\n(defun beads-hierarchy--status-face (status)\n  \"Return face for STATUS.\"\n  (pcase status\n    (\"closed\" 'beads-list-status-closed)\n    (\"in_progress\" 'beads-list-status-in-progress)\n    (_ 'beads-list-status-open)))\n```\n\n### Entry Point\n\n```elisp\n(defun beads-hierarchy-show (issue-id)\n  \"Display dependency tree for ISSUE-ID.\"\n  (interactive\n   (list (or (and (derived-mode-p 'beads-detail-mode)\n                  beads-detail--current-issue-id)\n             (read-string \"Issue ID: \"))))\n  (let* ((h (beads-hierarchy--build issue-id))\n         (buffer (get-buffer-create (format \"*beads-deps: %s*\" issue-id))))\n    (with-current-buffer buffer\n      (beads-hierarchy-mode)\n      (setq beads-hierarchy--root-id issue-id))\n    ;; Use tree-display for expandable nodes\n    (hierarchy-tree-display h #'beads-hierarchy--labelfn buffer)\n    (display-buffer buffer\n                    '((display-buffer-in-side-window)\n                      (side . right)\n                      (window-width . 0.4)))))\n```\n\n### Navigation\n\n```elisp\n(defun beads-hierarchy-goto-issue ()\n  \"Open detail view for issue at point.\"\n  (interactive)\n  (when-let* ((widget (widget-at (point)))\n              (issue (widget-get widget :node))\n              (id (alist-get 'id issue)))\n    (let ((full-issue (beads-rpc-show id)))\n      (beads-detail-open full-issue))))\n```\n\n## Keybinding Integration\n\nIn `beads-detail.el`, add:\n```elisp\n(define-key beads-detail-mode-map (kbd \"H\") #'beads-hierarchy-show)\n```\n\nIn transient menu, add under Navigation:\n```elisp\n(\"H\" \"Dependency tree\" beads-hierarchy-show)\n```\n\n## Display Considerations\n\n1. **Window placement**: Side window (right) keeps detail view visible\n2. **Tree widget**: Allows expand/collapse of branches\n3. **Clickable nodes**: Use `hierarchy-labelfn-button` for navigation\n4. **Status colors**: Reuse faces from beads-list for consistency\n\n## Alternative: Tabulated Display\n\nIf tree widget proves problematic, `hierarchy-tabulated-display` provides a flatter view with sortable columns - similar to existing list view but with indentation showing depth.\n\n## Testing\n\n1. Create issues with dependencies: `bd dep add bdel-xxx bdel-yyy`\n2. Open detail view for an issue with dependencies\n3. Press `H` to show tree\n4. Verify expand/collapse works\n5. Verify clicking navigates to issue","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T22:06:53.918232+01:00","updated_at":"2025-12-17T22:12:35.825192+01:00","closed_at":"2025-12-17T22:12:35.825192+01:00","close_reason":"Implemented using hierarchy.el with tree widget display","dependencies":[{"issue_id":"bdel-10j","depends_on_id":"bdel-c5c","type":"parent-child","created_at":"2025-12-17T22:07:00.303377+01:00","created_by":"daemon"}]}
{"id":"bdel-1ui","title":"Implement edit design notes feature","description":"Add 'e D' keybinding to edit design notes:\n- Same pattern as description editing\n- Opens markdown-mode buffer\n- C-c C-c commits via :design field\n- Buffer name: *beads-edit: ISSUE-ID design*","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T12:59:14.823839+01:00","updated_at":"2025-12-17T13:34:25.157363+01:00","closed_at":"2025-12-17T13:08:02.086461+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-1ui","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:36.984012+01:00","created_by":"daemon"}]}
{"id":"bdel-2u2","title":"Sorting options in list view","description":"Add commands to sort by different columns: priority, date, status, title. Currently defaults to date descending. Allow toggling sort direction.","design":"**Current:** Default sort by date descending, can click column headers\n\n**Explicit sort commands:**\n- `o` - Cycle sort column (like dired)\n- `O` - Reverse current sort direction\n- Or use prefix keymap `S`:\n  - `S p` - Sort by priority\n  - `S d` - Sort by date (created_at)\n  - `S u` - Sort by updated_at\n  - `S s` - Sort by status\n  - `S t` - Sort by title\n  - `S i` - Sort by ID\n\n**Implementation:**\n- `tabulated-list-mode` already supports sorting via `tabulated-list-sort-key`\n- Add commands that set sort key and refresh\n- Store sort preference in buffer-local or customize variable\n\n**CLI reference:** `bd list --sort priority|created|updated|status|id|title --reverse`","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T19:22:42.701354+01:00","updated_at":"2025-12-19T09:40:05.596736+01:00","closed_at":"2025-12-19T09:40:05.596736+01:00","close_reason":"Added o to cycle sort columns and O to reverse direction"}
{"id":"bdel-3ph","title":"Implement edit external-ref via minibuffer","description":"Add 'e x' keybinding to edit external reference:\n- Use read-string with current external-ref as default\n- Example values: gh-123, jira-ABC-456\n- Commit via beads-rpc-update with :external-ref","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T12:59:16.113614+01:00","updated_at":"2025-12-17T13:08:08.467113+01:00","closed_at":"2025-12-17T13:08:08.467113+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-3ph","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:45.339455+01:00","created_by":"daemon"}]}
{"id":"bdel-3v1","title":"Integrate undo with label operations","description":"Add undo recording to label add/remove in beads-detail.el:\n\n- beads-detail-edit-label-add: record old labels array, new labels array\n- beads-detail-edit-label-remove: record old labels array, new labels array\n\nFor undo, need to use beads-rpc-update with :set-labels to restore entire label array (simpler than tracking individual add/remove).","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T15:01:31.19597+01:00","updated_at":"2025-12-17T15:01:31.19597+01:00","dependencies":[{"issue_id":"bdel-3v1","depends_on_id":"bdel-dyk","type":"parent-child","created_at":"2025-12-17T15:01:46.113136+01:00","created_by":"daemon"},{"issue_id":"bdel-3v1","depends_on_id":"bdel-0kf","type":"blocks","created_at":"2025-12-17T15:01:58.973768+01:00","created_by":"daemon"}]}
{"id":"bdel-4dg","title":"Implement edit assignee via minibuffer","description":"Add 'e A' keybinding to edit assignee:\n- Use read-string with current assignee as default\n- Empty string clears assignee\n- Commit via beads-rpc-update with :assignee","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T12:59:15.673096+01:00","updated_at":"2025-12-17T13:08:08.297678+01:00","closed_at":"2025-12-17T13:08:08.297678+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-4dg","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:45.109044+01:00","created_by":"daemon"}]}
{"id":"bdel-4e6","title":"Integrate undo with beads-edit.el (markdown edits)","description":"Add undo recording to beads-edit--exit() for markdown field edits:\n\n- description, design, acceptance_criteria, notes\n- Call beads-undo-record before beads-rpc-update\n- Pass: issue-id, field keyword, original content, new content\n- Generate description like \"description on bdel-xyz\"\n\nEdit beads-edit.el lines ~71 to add the hook.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T15:01:30.841452+01:00","updated_at":"2025-12-17T15:01:30.841452+01:00","dependencies":[{"issue_id":"bdel-4e6","depends_on_id":"bdel-dyk","type":"parent-child","created_at":"2025-12-17T15:01:45.822357+01:00","created_by":"daemon"},{"issue_id":"bdel-4e6","depends_on_id":"bdel-0kf","type":"blocks","created_at":"2025-12-17T15:01:58.67914+01:00","created_by":"daemon"}]}
{"id":"bdel-51u","title":"Restore scroll position and point on refresh","description":"When refreshing list or detail views, the scroll position and point should be preserved. Currently refresh may jump to a different position.","design":"**Affected views:**\n- `beads-list-refresh` - list view\n- `beads-detail-refresh` - detail view\n- `beads-hierarchy-refresh` - hierarchy view\n\n**Current behavior:**\n- List view attempts to restore position by ID (`beads-list-goto-id`) but doesn't preserve scroll\n- Detail view goes to `(point-min)` after refresh\n\n**Desired behavior:**\n- Save `(window-start)` and `(point)` before refresh\n- After redisplay, restore both\n- If the issue at point was deleted, fall back to same line number\n\n**Implementation pattern:**\n```elisp\n(let ((saved-point (point))\n      (saved-start (window-start)))\n  ;; ... refresh content ...\n  (set-window-start (selected-window) saved-start)\n  (goto-char (min saved-point (point-max))))\n```\n\n**Edge cases:**\n- Content shorter after refresh (deleted issues)\n- Window not visible during refresh\n- Point was on a now-deleted item","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T22:19:29.057352+01:00","updated_at":"2025-12-17T22:39:37.956018+01:00","closed_at":"2025-12-17T22:39:37.956018+01:00","close_reason":"Implemented scroll position restoration in list, detail, and hierarchy refresh functions"}
{"id":"bdel-5as","title":"Comments support","description":"Add support for viewing and adding comments to issues. Need to verify RPC support or use CLI fallback.","design":"**CLI commands:**\n- `bd comments \u003cid\u003e` - List comments on issue\n- `bd comments add \u003cid\u003e \"text\"` - Add comment\n- `bd comments add \u003cid\u003e -f file.txt` - Add from file\n\n**First step:** Check if daemon has comments RPC operations. If not, use CLI fallback with `--json` flag.\n\n**UI design:**\n1. **Detail view section:** Show comments below notes, formatted as:\n   ```\n   Comments:\n   ─────────\n   [2024-01-15 10:30] alice:\n   This needs more testing before release.\n   \n   [2024-01-16 14:20] bob:\n   Added unit tests, ready for review.\n   ```\n\n2. **Add comment:** `c` binding in detail view\n   - Opens edit buffer (like description edit)\n   - On save, calls comments add RPC/CLI\n\n**Lower priority:** Edit/delete comments (if API supports)","status":"open","priority":3,"issue_type":"epic","created_at":"2025-12-17T19:22:32.177259+01:00","updated_at":"2025-12-17T21:09:51.588594+01:00"}
{"id":"bdel-5w1","title":"Milestone 1: Read issues from beads and display in interactive list","description":"Our first goal is to teach Emacs to run the Beats.el mode, Introduce that mode in the first place and in that mode list all issues from the Beats database. The database listing then shows in the table view the issue ID, the statios like priority, the kind of task it is, whether it's open or closed, and then also the title of course, but not the description. The description is reserved for the detail view display. So we have an overview and a detail view, and you get to the detail view by interacting with the overview, you're pressing return to essentially open the task in the viewer. Check out @docs/emacs-ui.md for how the UI works and @docs/beads-client-howto.md for the overall plan and approach","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-17T07:55:27.505205+01:00","updated_at":"2025-12-17T11:33:57.46743+01:00","closed_at":"2025-12-17T11:33:57.46743+01:00","close_reason":"All subtasks completed: RPC, list mode, detail view, entry point, transient menus, preview mode, state management, and filter system"}
{"id":"bdel-5z1","title":"Integrate undo with beads-detail.el (inline edits)","description":"Add undo recording to detail view inline edits:\n\n- beads-detail-edit-title (minibuffer)\n- beads-detail-edit-status (completing-read)\n- beads-detail-edit-priority (completing-read)\n- beads-detail-edit-type (completing-read)\n- beads-detail-edit-assignee (minibuffer)\n- beads-detail-edit-external-ref (minibuffer)\n\nEach function already has old value available. Add beads-undo-record call before RPC update.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T15:01:31.016841+01:00","updated_at":"2025-12-17T15:01:31.016841+01:00","dependencies":[{"issue_id":"bdel-5z1","depends_on_id":"bdel-dyk","type":"parent-child","created_at":"2025-12-17T15:01:45.965508+01:00","created_by":"daemon"},{"issue_id":"bdel-5z1","depends_on_id":"bdel-0kf","type":"blocks","created_at":"2025-12-17T15:01:58.822521+01:00","created_by":"daemon"}]}
{"id":"bdel-6qd","title":"Implement edit type with completing-read","description":"Add 'e T' keybinding to change issue type:\n- Use completing-read with options: bug, feature, task, epic, chore\n- Current type as default\n- Commit via beads-rpc-update with :issue-type","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T12:59:15.533546+01:00","updated_at":"2025-12-17T18:39:50.341031+01:00","closed_at":"2025-12-17T13:08:03.221699+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-6qd","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:37.500941+01:00","created_by":"daemon"}]}
{"id":"bdel-70w","title":"Improve list view columns","description":"Add more columns to list view: assignee, labels, type. Make columns configurable via customization variable.","design":"**Current columns:** ID, Date, Status, Pri, Title\n\n**Additional columns to add:**\n- Type (bug/feature/task/epic/chore) - short: B/F/T/E/C\n- Assignee (truncated to fit)\n- Labels (comma-separated, truncated)\n- Dependencies indicator (see below)\n\n**Dependency indicators:**\nShow relationship icons in a narrow column to indicate parent/child relationships:\n\n| Icon | Meaning |\n|------|---------|\n| `↑` | Has parent(s) - this issue depends on others |\n| `↓` | Has child(ren) - other issues depend on this |\n| `↕` | Has both parents and children |\n| ` ` | No dependencies |\n\nAlternative icon sets to consider:\n- Unicode: `▲` `▼` `◆` or `⬆` `⬇` `⬍`\n- ASCII fallback: `^` `v` `*`\n- Tree-style: `├` `└` `│` (for nested grouping view)\n- Blocked indicator: `⊗` or `✗` when blocked by open issues\n\nCould also use propertized text with faces:\n- Red `↑` when blocked by open parents\n- Green `↓` when all children are closed\n- Yellow `↕` for mixed state\n\n**Grouping alternative:**\nInstead of icons, could group issues by epic/parent in the list view using indentation or tree structure. This would require a different display mode toggle.\n\n**Customization:**\n```elisp\n(defcustom beads-list-columns\n  '(id date status priority title)\n  \"Columns to display in beads list view.\nAvailable: id, date, status, priority, type, title, assignee, labels, deps\"\n  :type '(repeat symbol)\n  :group 'beads)\n```\n\n**Column width customization:**\n```elisp\n(defcustom beads-list-column-widths\n  '((id . 10) (title . 50) (assignee . 12) (deps . 3))\n  \"Width overrides for list columns.\"\n  :type '(alist :key-type symbol :value-type integer))\n```\n\n**Implementation:** Modify `beads-list--format` to build columns dynamically based on customization.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T19:22:42.547622+01:00","updated_at":"2025-12-19T20:58:23.740639+01:00","closed_at":"2025-12-19T20:58:23.740639+01:00","close_reason":"Added configurable columns with beads-list-columns, plus assignee, labels, and deps columns"}
{"id":"bdel-7mu","title":"Integrate undo with beads-form.el (batch edits)","description":"Add undo recording to beads-form-commit for multi-field edits:\n\n- Create compound undo entry with field type :batch\n- old-value: alist of all original field values\n- new-value: alist of all new field values\n- On undo, call beads-rpc-update with all old values at once\n\nThis ensures form edits undo as a single operation, not field-by-field.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T15:01:31.378955+01:00","updated_at":"2025-12-17T15:01:31.378955+01:00","dependencies":[{"issue_id":"bdel-7mu","depends_on_id":"bdel-dyk","type":"parent-child","created_at":"2025-12-17T15:01:46.256071+01:00","created_by":"daemon"},{"issue_id":"bdel-7mu","depends_on_id":"bdel-0kf","type":"blocks","created_at":"2025-12-17T15:01:59.112886+01:00","created_by":"daemon"}]}
{"id":"bdel-92j","title":"Form editor: colons in text content break field boundaries","description":"When a description or other multi-line text field contains colons, the field boundary detection is wrong. The greedy regex matches the last colon, making part of the content appear as a label (non-editable) while only the text after the last colon is editable.\n\nExample: \"Description: some text with: embedded colons\" - only \"embedded colons\" becomes editable.","design":"**Root cause**: Likely in `beads-form--add-text-field` or the face/property application.\n\n**Fix approach**: The label (\"Description:\") should be rendered separately from the widget value. Don't use regex to split - render label with `widget-insert`, then create widget for value only.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T18:33:21.523974+01:00","updated_at":"2025-12-17T18:41:32.616755+01:00","closed_at":"2025-12-17T18:41:32.616755+01:00","close_reason":"Fixed by overriding text widget format to \"%v\" instead of default \"%{%t%}: %v\""}
{"id":"bdel-9ik","title":"Form editor: derive from nil, not special-mode","description":"Fixed bug where text fields in the form editor (E) couldn't receive keyboard input.","design":"**Design Decision**: `beads-form-mode` derives from `nil` (fundamental-mode), not `special-mode`.\n\n**Rationale**:\n- `special-mode` sets `buffer-read-only t`, which blocks editable-field and text widgets\n- Menu-choice widgets worked because they use overlays/keymaps, bypassing buffer modification\n- Emacs's built-in `Custom-mode` (cus-edit.el) uses the same pattern: `(define-derived-mode Custom-mode nil \"Custom\" ...)`\n- `special-mode` is designed for read-only display buffers (help, completion lists)\n- Widget-based editable forms should derive from `nil`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T18:31:20.351046+01:00","updated_at":"2025-12-17T18:31:24.350772+01:00","closed_at":"2025-12-17T18:31:24.350772+01:00","close_reason":"Fixed in commits c9da5d7 and 68313f8"}
{"id":"bdel-a1v","title":"Implement edit notes feature","description":"Add 'e n' keybinding to edit notes:\n- Same markdown-mode buffer pattern as description\n- C-c C-c commits via :notes field\n- Buffer name: *beads-edit: ISSUE-ID notes*","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T12:59:15.959924+01:00","updated_at":"2025-12-17T13:08:02.492684+01:00","closed_at":"2025-12-17T13:08:02.492684+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-a1v","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:45.257015+01:00","created_by":"daemon"}]}
{"id":"bdel-ab3","title":"Milestone 2: Editing tasks from list and detail view","description":"Enable editing of beads issues from within Emacs, with a rich editing experience for long-form text fields (description, design, acceptance criteria) and convenient completion-based editing for metadata fields.\n\nKey patterns to implement:\n- Dedicated edit buffers for long text (like org-src-mode) with C-c C-c to commit, C-c C-k to discard\n- completing-read for constrained fields (status, priority, type)\n- Minibuffer for simple text fields (title, assignee, external-ref)\n- Stretch: form-based UI like custom.el for metadata editing\n\nAll fields from `bd update` should be editable:\n- title, description, status, priority, type, assignee\n- design, acceptance (criteria), notes, external-ref, estimate\n- labels (add/remove/set)","design":"Research findings (org-src-mode pattern):\n1. Create dedicated buffer with buffer-local markers for source positions\n2. Store original content for abort comparison\n3. Use single code path with gate flag (org-src--allow-write-back pattern)\n4. Minor mode provides C-c C-c (commit) and C-c C-k (abort) bindings\n5. On commit: call beads-rpc-update with changed field\n6. On abort: just kill buffer, no RPC call\n\nFor long text fields: use markdown-mode in edit buffer\nFor metadata: completing-read or form UI","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-17T12:58:43.587904+01:00","updated_at":"2025-12-17T13:17:00.981304+01:00","closed_at":"2025-12-17T13:17:00.981304+01:00","close_reason":"All core editing features implemented: markdown buffers for long text, completing-read for constrained fields, minibuffer for text fields, and label management. Stretch goal (form-based editor) remains optional."}
{"id":"bdel-aw7","title":"Implement filter system","description":"Create beads-filter.el with composable higher-order filters. Filter by status, priority, type, assignee. Pipeline composition pattern. See docs/emacs-ui.md Section 5.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T08:06:09.823743+01:00","updated_at":"2025-12-17T11:33:46.401209+01:00","closed_at":"2025-12-17T11:33:46.401209+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-aw7","depends_on_id":"bdel-5w1","type":"parent-child","created_at":"2025-12-17T08:06:21.650688+01:00","created_by":"daemon"},{"issue_id":"bdel-aw7","depends_on_id":"bdel-dkc","type":"blocks","created_at":"2025-12-17T08:06:31.832389+01:00","created_by":"daemon"}]}
{"id":"bdel-b3t","title":"Project.el integration for per-project beads lists","description":"Add project.el integration so each project can have its own beads list buffer with a unique name.\n\nRequirements:\n1. New `beads-project.el` extension module\n2. Buffer name includes project identifier (root directory name)\n3. Multiple beads list buffers can coexist for different projects\n4. `beads-list` command should be project-aware when called from project context\n5. Optional: project.el integration for `project-switch-project` actions\n\nUse cases:\n- Working on multiple projects simultaneously\n- Switching between projects without losing beads list state\n- Each project's list buffer persists independently\n\nBuffer naming:\n- Current: `*Beads Issues*`\n- With project: `*Beads Issues: project-name*` or `*Beads: ~/code/myproject*`","design":"Implementation plan:\n\n## 1. Create `beads-project.el`\n\n```elisp\n(require 'project)\n\n(defcustom beads-project-buffer-name-function\n  #'beads-project-default-buffer-name\n  \"Function to generate buffer name for project beads list.\nCalled with project root path, returns buffer name string.\"\n  :type 'function\n  :group 'beads)\n\n(defun beads-project-root ()\n  \"Get current project root, or nil if not in a project.\"\n  (when-let ((proj (project-current)))\n    (project-root proj)))\n\n(defun beads-project-name (root)\n  \"Extract project name from ROOT path.\"\n  (file-name-nondirectory (directory-file-name root)))\n\n(defun beads-project-default-buffer-name (root)\n  \"Generate default buffer name for project at ROOT.\"\n  (format \"*Beads: %s*\" (beads-project-name root)))\n\n(defun beads-project-list ()\n  \"Open beads list for current project.\"\n  (interactive)\n  (if-let ((root (beads-project-root)))\n      (let ((default-directory root))\n        (beads-list))\n    (beads-list)))\n```\n\n## 2. Update `beads-list` to use project-aware buffer name\n\n```elisp\n(defun beads-list ()\n  \"Open the Beads issue list buffer.\"\n  (interactive)\n  (let* ((root (and (featurep 'beads-project)\n                    (beads-project-root)))\n         (buffer-name (if root\n                          (funcall beads-project-buffer-name-function root)\n                        \"*Beads Issues*\"))\n         (buffer (get-buffer-create buffer-name)))\n    ...))\n```\n\n## 3. Optional: Add to project.el switch actions\n\n```elisp\n(defun beads-project-switch-action ()\n  \"Switch action to open beads list in project.\"\n  (beads-project-list))\n\n;; Add to project-switch-commands\n(add-to-list 'project-switch-commands\n             '(beads-project-list \"Beads issues\"))\n```\n\n## 4. Store project root in buffer-local variable\n\n```elisp\n(defvar-local beads-list--project-root nil\n  \"Project root for this beads list buffer.\")\n```\n\nThis ensures refresh uses the correct project context.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T13:52:42.046797+01:00","updated_at":"2025-12-17T14:06:10.320361+01:00","closed_at":"2025-12-17T14:06:10.320361+01:00","close_reason":"Implemented: beads-project.el with per-project buffer names, project-switch-commands integration, customizable buffer naming, and README.org documentation"}
{"id":"bdel-bum","title":"Implement edit description feature","description":"Add 'e d' keybinding in detail view to edit description:\n- Opens dedicated buffer in markdown-mode\n- Pre-populates with current description (or empty)\n- C-c C-c commits via beads-rpc-update with :description\n- C-c C-k discards\n- Buffer name: *beads-edit: ISSUE-ID description*\n- Refresh detail view after successful commit","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T12:59:14.695125+01:00","updated_at":"2025-12-17T13:08:01.906545+01:00","closed_at":"2025-12-17T13:08:01.906545+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-bum","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:36.894485+01:00","created_by":"daemon"},{"issue_id":"bdel-bum","depends_on_id":"bdel-ohr","type":"blocks","created_at":"2025-12-17T12:59:51.028465+01:00","created_by":"daemon"}]}
{"id":"bdel-byj","title":"(Stretch) Form-based metadata editor","description":"Create a custom.el-style form buffer for editing all metadata at once:\n- Display all editable fields in a widget-based form\n- Dropdown/choice widgets for status, priority, type\n- Text fields for title, assignee, external-ref\n- Multi-line text areas for description, design, acceptance, notes\n- Labels as editable list\n- Submit button or C-c C-c to commit all changes\n- Cancel button or C-c C-k to discard\n\nThis is a stretch goal - the individual field editors provide the core functionality.","design":"Use widget.el library (what custom.el uses):\n- widget-create for form fields\n- widget-value to read values\n- widget-setup for buffer initialization\nConsider ewoc.el for list management (labels)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T12:59:16.2794+01:00","updated_at":"2025-12-17T13:38:00.359531+01:00","closed_at":"2025-12-17T13:38:00.359531+01:00","close_reason":"Implemented widget-based form editor with all metadata fields, C-c C-c/C-c C-k keybindings, and 'E' shortcut from detail view","dependencies":[{"issue_id":"bdel-byj","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:45.420843+01:00","created_by":"daemon"}]}
{"id":"bdel-c0n","title":"Implement filter by status","description":"Add functionality to filter the issue list by status (open, in_progress, blocked, closed). Currently shows \"Filter by status not yet implemented\" message in beads-transient.el.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T14:11:19.312379+01:00","updated_at":"2025-12-17T14:41:46.890994+01:00","closed_at":"2025-12-17T14:41:46.890994+01:00","close_reason":"Implemented: completing-read for status, filters list, shows filter name in refresh message"}
{"id":"bdel-c5c","title":"Dependencies management","description":"Add UI for managing issue dependencies. Beads supports dependencies (blocks, related, parent-child, discovered-from). RPC already exists for dep_add, dep_remove, dep_tree.","design":"**Scope reduced**: Focus on viewing only, editing dependencies is low priority.\n\n**View-only approach:**\n- Display dependencies in detail view (already shows dependency_count)\n- Add 'H' binding from detail view to open hierarchy explorer in horizontal split\n- Use Emacs hierarchy.el or similar for tree visualization\n- Show: blocked by (issues blocking this), blocks (issues this blocks), related\n\n**Not in scope:**\n- Adding/removing dependencies via UI (use CLI: `bd dep add/remove`)\n- Inline editing of dependency relationships\n\n**Technical notes:**\n- RPC exists: dep_tree returns full dependency graph\n- Could use `hierarchy.el` package for tree rendering\n- Split window to right of detail pane","status":"open","priority":4,"issue_type":"epic","created_at":"2025-12-17T19:22:31.864537+01:00","updated_at":"2025-12-17T21:08:50.563344+01:00"}
{"id":"bdel-cqp","title":"Implement create issue command","description":"Add functionality to create new issues from within beads.el. Currently shows \"Create issue not yet implemented\" message in beads-transient.el.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T14:11:19.050639+01:00","updated_at":"2025-12-17T14:37:56.540081+01:00","closed_at":"2025-12-17T14:37:56.540081+01:00","close_reason":"Implemented: prompts for title, type, priority; creates via RPC; refreshes list"}
{"id":"bdel-d29","title":"Implement edit priority with completing-read","description":"Add 'e p' keybinding to change priority:\n- Use completing-read with options: P0 (critical), P1 (high), P2 (normal), P3 (low), P4 (lowest)\n- Show current priority as default\n- Convert selection to integer for RPC\n- Commit via beads-rpc-update with :priority","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T12:59:15.380685+01:00","updated_at":"2025-12-17T13:08:03.04369+01:00","closed_at":"2025-12-17T13:08:03.04369+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-d29","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:37.41087+01:00","created_by":"daemon"}]}
{"id":"bdel-df8","title":"Additional list filters and views","description":"Extend list view with more filtering and view options beyond status/priority.","design":"**Currently implemented:** Filter by status (f s), filter by priority (f p)\n\n**Nested Transient Approach:**\nA transient prefix bound as a suffix replaces the current transient. Pressing C-g returns to parent.\n\n**Structure:**\n```\nbeads-list-menu (main, ?)\n├── Navigation: g, P\n├── Actions: c, E, x, R, D\n├── Filter → beads-filter-menu (nested prefix, f)\n│   ├── s - By status\n│   ├── p - By priority  \n│   ├── t - By type\n│   ├── a - By assignee\n│   ├── l - By label\n│   ├── r - Ready only (no blockers)\n│   ├── b - Blocked only\n│   └── c - Clear all filters\n└── Help: ?, q\n```\n\n**Implementation:**\n1. Create `beads-filter-menu` as `transient-define-prefix`\n2. Add filter commands: `beads-filter-type`, `beads-filter-assignee`, `beads-filter-label`, `beads-filter-ready`, `beads-filter-blocked`, `beads-filter-clear`\n3. Replace current \"Filter\" group in `beads-list-menu` with single entry pointing to `beads-filter-menu`\n4. Direct `f` keymap binding still works for quick access\n\n**Filter functions need:**\n- Type filter: completing-read from '(\"bug\" \"feature\" \"task\" \"epic\" \"chore\")\n- Assignee: completing-read, may need to fetch list from existing issues\n- Label: completing-read, may need to fetch list from existing issues  \n- Ready: Use `beads-rpc-ready` or filter by dependency_count = 0\n- Blocked: Filter by status = \"blocked\"\n- Clear: Set `beads-list--filter` to nil\n\n**Note:** Ready/Blocked may need RPC support or client-side filtering based on blocked_by dependencies.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-17T19:22:32.01746+01:00","updated_at":"2025-12-17T21:38:12.823052+01:00","closed_at":"2025-12-17T21:38:12.823052+01:00","close_reason":"Implemented nested filter menu with type, assignee, label, ready, blocked, and clear filters"}
{"id":"bdel-dkc","title":"Implement state management","description":"Create beads-state.el with closure-based state manager for view mode, filters, and UI state. Lazy initialization pattern. See docs/emacs-ui.md Section 7.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T08:06:09.744782+01:00","updated_at":"2025-12-17T11:32:32.087389+01:00","closed_at":"2025-12-17T11:32:32.087389+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-dkc","depends_on_id":"bdel-5w1","type":"parent-child","created_at":"2025-12-17T08:06:21.592648+01:00","created_by":"daemon"}]}
{"id":"bdel-dq1","title":"Implement filter by priority","description":"Add functionality to filter the issue list by priority (P0-P4). Currently shows \"Filter by priority not yet implemented\" message in beads-transient.el.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T14:11:19.446423+01:00","updated_at":"2025-12-17T14:41:47.017222+01:00","closed_at":"2025-12-17T14:41:47.017222+01:00","close_reason":"Implemented: completing-read for priority P0-P4, filters list, shows filter name in refresh message"}
{"id":"bdel-dyk","title":"Implement undo/redo for editing commands","description":"Add undo/redo capability for issue editing operations using the Command Pattern.\n\n## Research Findings\n\n**Emacs buffer-undo-list is NOT suitable** for this use case:\n- It's designed exclusively for buffer text changes\n- External state (database updates via RPC) cannot use it\n- No major Emacs packages (magit, org-mode, etc.) implement undo for external operations\n\n**Recommended approach: Command Pattern**\n- Store reverse operations as closures in a custom undo stack\n- Each edit captures: issue-id, field, old-value, new-value, timestamp\n- Undo pops from stack, calls RPC with old value, pushes to redo stack\n- Redo pops from redo stack, re-applies, pushes back to undo stack\n\n## Current Edit Flow (insertion points identified)\n\n```\nUser initiates edit\n    ↓\nbeads-edit-field() captures original content in beads-edit--original-content\n    ↓\nUser modifies content\n    ↓\nC-c C-c triggers beads-edit--exit()\n    ↓\n★ UNDO HOOK: Before beads-rpc-update() - have old+new values\n    ↓\nbeads-rpc-update(issue-id, field, new-value)\n    ↓\nbeads-detail-refresh() updates views\n```\n\n## Design Decisions\n\n1. **Scope**: Global undo stack (not per-buffer/per-issue) - simpler, more intuitive\n2. **Persistence**: Session-only (no disk persistence) - avoids complexity and stale state\n3. **Redo**: Yes, full undo/redo support\n4. **Stack size**: Configurable limit (default: 50 operations)\n5. **Form edits**: Single undo entry for all fields changed together\n6. **Conflicts**: Check issue still exists before undo, warn if externally modified\n\n## Keybindings\n\n- `u` - Undo last edit (detail and list modes)\n- `U` or `C-S-/` - Redo","design":"## Architecture\n\n### beads-undo.el module structure\n\n```elisp\n;; Undo entry structure\n(cl-defstruct beads-undo-entry\n  issue-id       ; string\n  field          ; keyword like :title, :description (or :batch for form edits)\n  old-value      ; value before edit\n  new-value      ; value after edit  \n  timestamp      ; when edit occurred\n  description)   ; human-readable description\n\n;; Stacks\n(defvar beads-undo--stack nil \"List of undo entries, most recent first.\")\n(defvar beads-undo--redo-stack nil \"List of redo entries.\")\n(defcustom beads-undo-limit 50 \"Maximum undo history size.\")\n\n;; Core API\n(defun beads-undo-record (issue-id field old-value new-value \u0026optional description)\n  \"Record an edit for undo. Clears redo stack.\")\n\n(defun beads-undo ()\n  \"Undo last edit. Moves entry to redo stack.\"\n  (interactive))\n\n(defun beads-redo ()\n  \"Redo last undone edit. Moves entry back to undo stack.\"\n  (interactive))\n```\n\n### Integration Points\n\n1. **beads-edit.el** - Wrap beads-edit--exit()\n2. **beads-detail.el** - Wrap inline edits (status, priority, type, labels)\n3. **beads-form.el** - Wrap form commit with batch entry\n4. **beads-list.el** - Wrap list-mode inline edits\n\n### Conflict Detection\n\nBefore applying undo:\n1. Fetch current issue via beads-rpc-show\n2. Compare current value with undo-entry's new-value\n3. If different: warn \"Issue was modified externally\"\n4. If issue deleted: error \"Issue no longer exists\"\n\n### Form Edit Batch Undo\n\nFor form edits changing multiple fields:\n- Store as single entry with :batch field type\n- old-value/new-value: alists of (field . val) pairs\n- Undo applies all fields at once","status":"open","priority":3,"issue_type":"epic","created_at":"2025-12-17T13:38:12.284551+01:00","updated_at":"2025-12-17T17:53:24.892646+01:00"}
{"id":"bdel-e7i","title":"Implement RPC layer for daemon communication","description":"Create beads-rpc.el with JSON-over-Unix-socket communication to the beads daemon. See docs/beads-client-howto.md for protocol details and docs/emacs-ui.md Section 1 for architecture.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T08:06:09.439311+01:00","updated_at":"2025-12-17T08:25:00.286253+01:00","closed_at":"2025-12-17T08:25:00.286253+01:00","close_reason":"Implemented beads-rpc.el with auto-discovery, daemon communication, high-level API functions, and comprehensive tests. Verified working with daemon.","dependencies":[{"issue_id":"bdel-e7i","depends_on_id":"bdel-5w1","type":"parent-child","created_at":"2025-12-17T08:06:21.414017+01:00","created_by":"daemon"},{"issue_id":"bdel-e7i","depends_on_id":"bdel-jlb","type":"blocks","created_at":"2025-12-17T08:11:42.943792+01:00","created_by":"daemon"}]}
{"id":"bdel-eja","title":"Add conflict detection for undo operations","description":"Before applying undo, check for conflicts:\n\n1. Fetch current issue via beads-rpc-show\n2. Compare current field value with undo-entry's new-value\n3. If different: prompt \"Issue was modified externally. Undo anyway? (y/n)\"\n4. If issue deleted (RPC error): show \"Issue no longer exists\"\n5. If user confirms or no conflict: proceed with undo\n\nThis prevents silent data loss when issue was modified by another client or CLI.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-17T15:01:31.92797+01:00","updated_at":"2025-12-17T15:01:31.92797+01:00","dependencies":[{"issue_id":"bdel-eja","depends_on_id":"bdel-dyk","type":"parent-child","created_at":"2025-12-17T15:01:46.729896+01:00","created_by":"daemon"},{"issue_id":"bdel-eja","depends_on_id":"bdel-0kf","type":"blocks","created_at":"2025-12-17T15:01:59.552336+01:00","created_by":"daemon"}]}
{"id":"bdel-fcc","title":"Set up interactive testing infrastructure","description":"Create infrastructure for interactive Q\u0026A testing of the library.\n\nSet up a way to run Emacs from command line with minimal config that loads beads.el:\n- Use --init-directory to point to a test config directory\n- Create test/interactive/ or similar with init.el that loads the library\n- Add mise task like `mise run interactive` to launch it\n- Document the interactive testing workflow\n\nThis allows manual testing and experimentation without affecting user's Emacs config.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T08:53:52.049042+01:00","updated_at":"2025-12-17T08:57:16.549998+01:00","closed_at":"2025-12-17T08:57:16.549998+01:00","close_reason":"Added dev/init.el and mise run interactive task"}
{"id":"bdel-gww","title":"Dynamic title width in hierarchy view","description":"Currently hierarchy titles are hard-truncated at 40 characters. Should use available window width instead, adapting to the actual space available.","design":"**Current Implementation:**\n```elisp\n(insert (truncate-string-to-width title 40 nil nil \"…\"))\n```\n\n**Research Findings:**\n\n1. **`window-body-width`** - Returns usable text width of window\n   - Can be called at render time to get actual width\n   - Returns columns (character widths)\n\n2. **`truncate-string-to-width`** supports:\n   - `ELLIPSIS` param for custom ellipsis string (default \"…\")\n   - `ELLIPSIS-TEXT-PROPERTY` - uses `display` property instead of actual truncation\n     (visually truncates but keeps full string - interesting for tooltips)\n\n3. **Indentation consideration:**\n   - The `labelfn` receives `indent` parameter (currently ignored)\n   - Tree widgets add ~2-3 chars per level for expand/collapse icons\n   - Each indent level is typically 2 spaces\n\n**Proposed Implementation:**\n\n```elisp\n(defun beads-hierarchy--labelfn (issue indent)\n  \"Insert formatted ISSUE at INDENT level.\"\n  (let* ((id (alist-get 'id issue))\n         (title (alist-get 'title issue \"\"))\n         (status (alist-get 'status issue \"open\"))\n         ;; Calculate available width:\n         ;; window-width - indent - id-width - status-width - spacing\n         (id-width (+ 1 (length id)))        ; \" bdel-xxx\"\n         (status-width (+ 3 (length status))) ; \" [status]\"\n         (indent-width (* indent 2))          ; hierarchy indentation\n         (widget-width 3)                     ; tree widget icon\n         (available (- (window-body-width) \n                       indent-width widget-width \n                       id-width status-width 4)))\n    (insert \" \")\n    (insert (propertize id 'face 'beads-detail-id-face))\n    (insert \" \")\n    (insert (truncate-string-to-width title (max 10 available) nil nil \"…\"))\n    (insert \" \")\n    (insert (propertize (format \"[%s]\" status)\n                        'face (beads-hierarchy--status-face status)))))\n```\n\n**Edge Cases:**\n- Very narrow windows: use minimum width (10 chars)\n- Window resize: content won't auto-update (acceptable, user can refresh)\n\n**Alternative: Right-aligned status**\nCould use `display` property with `:align-to` to right-align status at window edge, giving title maximum space. More complex but cleaner look.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-18T07:38:07.400491+01:00","updated_at":"2025-12-19T09:36:09.660517+01:00","closed_at":"2025-12-19T09:36:09.660517+01:00","close_reason":"Implemented using window-body-width to calculate available title space dynamically"}
{"id":"bdel-hfe","title":"Fix TAB navigation in hierarchy view","description":"TAB/S-TAB to navigate between widgets only works when point is already on a widget. If you use arrow keys to move into empty indentation space, TAB does nothing.","design":"**Root Cause:**\n`beads-hierarchy-mode` derives from `special-mode`. The `widget-keymap` with TAB→`widget-forward` is only active on widget overlays, not buffer-wide. Empty space between widgets has no overlay, so TAB falls back to the major mode map which has no TAB binding.\n\n**Simple Fix (Phase 1):**\nAdd TAB and S-TAB bindings directly to `beads-hierarchy-mode-map`:\n\n```elisp\n(defvar beads-hierarchy-mode-map\n  (let ((map (make-sparse-keymap)))\n    (define-key map (kbd \"q\") #'quit-window)\n    (define-key map (kbd \"g\") #'beads-hierarchy-refresh)\n    (define-key map (kbd \"RET\") #'beads-hierarchy-goto-issue)\n    (define-key map (kbd \"TAB\") #'widget-forward)\n    (define-key map (kbd \"\u003cbacktab\u003e\") #'widget-backward)\n    map))\n```\n\nThis makes TAB work from anywhere in the buffer.\n\n**Alternative Considered:**\nSetting `(set-keymap-parent map widget-keymap)` - but this might conflict with special-mode bindings.\n\n**Future Enhancement (Phase 2):**\nMake TAB cycle through both widgets (fold/unfold) AND issue links (titles). This would require a custom navigation function:\n\n```elisp\n(defun beads-hierarchy-next-interactable ()\n  \"Move to next widget or issue link.\"\n  ;; Find next widget OR next issue ID link\n  ;; Interactables: tree widgets, issue ID/title text\n  )\n```\n\nThis fits hierarchy.el's design since the package is display-focused; navigation customization is left to the consuming mode.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-18T07:28:46.831749+01:00","updated_at":"2025-12-18T07:32:24.414536+01:00","closed_at":"2025-12-18T07:32:24.414536+01:00","close_reason":"Added TAB and backtab bindings to hierarchy mode map"}
{"id":"bdel-ijt","title":"Implement detail view mode","description":"Create beads-detail.el for formatted issue display. Show full issue details with faces for visual hierarchy. Accessible via RET from list. See docs/emacs-ui.md Section 4.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T08:06:09.586503+01:00","updated_at":"2025-12-17T09:06:58.966727+01:00","closed_at":"2025-12-17T09:06:58.966727+01:00","close_reason":"Implemented beads-detail.el with formatted display, faces, side-window, and list integration","dependencies":[{"issue_id":"bdel-ijt","depends_on_id":"bdel-5w1","type":"parent-child","created_at":"2025-12-17T08:06:21.498122+01:00","created_by":"daemon"},{"issue_id":"bdel-ijt","depends_on_id":"bdel-e7i","type":"blocks","created_at":"2025-12-17T08:06:31.756501+01:00","created_by":"daemon"}]}
{"id":"bdel-irl","title":"Add delete issue command","description":"Add command to delete issues from list and detail views. RPC already exists (beads-rpc-delete). Should prompt for confirmation.","design":"**Behavior:**\n- Binding: 'D' in list and detail views\n- Prompt with `yes-or-no-p`: \"Permanently delete issue bdel-xxx? \"\n- On confirm: call `beads-rpc-delete`, refresh view, show message\n- No undo available - deletion is permanent\n\n**CLI equivalent:** `bd delete \u003cid\u003e`\n\n**RPC:** `beads-rpc-delete` already exists, accepts list of IDs\n\n**Edge cases:**\n- Issue has dependents: warn user or let daemon handle\n- Issue is epic with children: warn about orphaning children","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T19:22:18.495051+01:00","updated_at":"2025-12-17T21:15:59.081221+01:00","closed_at":"2025-12-17T21:15:59.081221+01:00","close_reason":"Implemented with D keybinding and yes-or-no-p confirmation"}
{"id":"bdel-jlb","title":"Set up Emacs Lisp development tooling (syntax checking, testing, mise tasks)","description":"Set up development infrastructure before implementing RPC layer:\n- Configure mise tasks for build/test/lint\n- Set up elisp syntax checking (check-parens, byte-compilation)\n- Create test framework setup\n- Document in CLAUDE.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T08:11:35.432695+01:00","updated_at":"2025-12-17T08:15:57.053017+01:00","closed_at":"2025-12-17T08:15:57.053017+01:00","close_reason":"Tooling setup complete: mise tasks for lint/test/build/check, Python scripts, ERT test framework, CLAUDE.md updated"}
{"id":"bdel-k07","title":"Enhanced TAB navigation in hierarchy (widgets + titles)","description":"Make TAB cycle through all interactable elements: tree widgets (fold/unfold) AND issue titles (open detail view).","design":"**Current State (after bdel-hfe):**\nTAB navigates between tree widgets only (fold/unfold controls).\n\n**Desired Behavior:**\nTAB cycles through ALL interactable elements in order:\n1. Tree widget (▶/▼) - RET toggles fold\n2. Issue title/ID - RET opens detail view\n3. Next tree widget\n4. Next issue title/ID\n...and so on.\n\nS-TAB goes in reverse.\n\n**Implementation Approach:**\n\n```elisp\n(defun beads-hierarchy-next-interactable (\u0026optional backward)\n  \"Move to next interactable element.\nInteractables are: tree widgets, issue IDs/titles.\"\n  (interactive)\n  (let ((pos (point))\n        (found nil))\n    ;; Collect all interactable positions:\n    ;; - widget-at positions (tree controls)\n    ;; - text with 'beads-issue-id property (issue links)\n    ;; Navigate to next one in buffer order\n    ))\n```\n\n**Alternative: Button-based approach**\nUse `make-text-button` on issue IDs during rendering so `widget-forward` naturally includes them. This would be cleaner but requires changes to `beads-hierarchy--labelfn`.\n\n**Design Fit:**\nThis extends hierarchy.el appropriately - the package provides tree display, we add navigation suited to our content (issues with actionable IDs).","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-18T07:29:01.445486+01:00","updated_at":"2025-12-19T09:40:05.649928+01:00","closed_at":"2025-12-19T09:40:05.649928+01:00","close_reason":"TAB now navigates both tree widgets and issue ID buttons","dependencies":[{"issue_id":"bdel-k07","depends_on_id":"bdel-hfe","type":"blocks","created_at":"2025-12-18T07:29:01.446278+01:00","created_by":"daemon"}]}
{"id":"bdel-lo4","title":"Implement edit acceptance criteria feature","description":"Add 'e a' keybinding to edit acceptance criteria:\n- Same pattern as description editing\n- Opens markdown-mode buffer\n- C-c C-c commits via :acceptance-criteria field\n- Buffer name: *beads-edit: ISSUE-ID acceptance*","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T12:59:14.953621+01:00","updated_at":"2025-12-17T13:08:02.294863+01:00","closed_at":"2025-12-17T13:08:02.294863+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-lo4","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:37.06981+01:00","created_by":"daemon"}]}
{"id":"bdel-m6t","title":"Add search command","description":"Add interactive search command. The list RPC already supports title_contains and description_contains filters. Prompt for search query, show results in list view.","design":"**Behavior:**\n- Binding: '/' or 's' in list view\n- Prompt: \"Search issues: \"\n- Search across title and description (case-insensitive)\n- Show results in list view with filter indicator\n\n**CLI equivalent:** `bd search \"query\" --status open`\n\n**RPC approach:**\nUse `beads-rpc-list` with filters:\n- `title_contains`: search query\n- `description_contains`: search query\n- Combine with OR logic if possible, or search title first\n\n**UI flow:**\n1. Prompt for search query\n2. Set `beads-list--filter` to search predicate\n3. Refresh list view\n4. Show \"Search: query\" in mode line or header","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T19:22:18.96414+01:00","updated_at":"2025-12-17T21:57:51.179374+01:00","closed_at":"2025-12-17T21:57:51.179374+01:00","close_reason":"Implemented search via '/' keybinding - searches title and description case-insensitively"}
{"id":"bdel-nde","title":"Create main entry point and autoloads","description":"Create beads.el as main entry point with autoloads, provide beads feature, and M-x beads command to launch the interface.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T08:06:09.98446+01:00","updated_at":"2025-12-17T09:11:49.517586+01:00","closed_at":"2025-12-17T09:11:49.517586+01:00","close_reason":"Created beads.el with package header, autoloads, and M-x beads command","dependencies":[{"issue_id":"bdel-nde","depends_on_id":"bdel-5w1","type":"parent-child","created_at":"2025-12-17T08:06:21.777537+01:00","created_by":"daemon"},{"issue_id":"bdel-nde","depends_on_id":"bdel-ppm","type":"blocks","created_at":"2025-12-17T08:06:31.913243+01:00","created_by":"daemon"}]}
{"id":"bdel-ohr","title":"Create beads-edit.el infrastructure","description":"Create the base editing infrastructure module with:\n- `beads-edit-mode` minor mode for dedicated edit buffers\n- Buffer-local variables: issue-id, field-name, original-content, allow-write-back\n- `beads-edit-commit` (C-c C-c) - saves changes via RPC, kills buffer\n- `beads-edit-abort` (C-c C-k) - discards changes, kills buffer\n- `beads-edit--create-buffer` helper to set up edit buffer with proper state\n- Hook into appropriate major mode (markdown-mode for text fields)","design":"Follow org-src-mode patterns:\n- Single code path for exit with gate flag\n- Buffer-local state, not global\n- Restore window configuration on exit\n- Optional: overlay on source buffer to show \"editing in progress\"","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T12:59:14.571781+01:00","updated_at":"2025-12-17T13:05:14.031982+01:00","closed_at":"2025-12-17T13:05:14.031982+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-ohr","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:36.812795+01:00","created_by":"daemon"}]}
{"id":"bdel-ppm","title":"Implement issue list mode with tabulated-list","description":"Create beads-list.el using tabulated-list-mode. Display columns: ID, status, priority, type, title. See docs/emacs-ui.md Section 2 for column definitions pattern.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T08:06:09.511876+01:00","updated_at":"2025-12-17T08:53:51.989095+01:00","closed_at":"2025-12-17T08:53:51.989095+01:00","close_reason":"Implemented beads-list.el with tabulated-list-mode, formatters, keybindings, and comprehensive tests. Verified working with daemon.","dependencies":[{"issue_id":"bdel-ppm","depends_on_id":"bdel-5w1","type":"parent-child","created_at":"2025-12-17T08:06:21.454582+01:00","created_by":"daemon"},{"issue_id":"bdel-ppm","depends_on_id":"bdel-e7i","type":"blocks","created_at":"2025-12-17T08:06:31.717382+01:00","created_by":"daemon"}]}
{"id":"bdel-rny","title":"Add transient menu for list column configuration","description":"Add nested transient to configure list columns buffer-locally. Should include toggles for individual columns with proper ordering, and option to edit the full config variable directly.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-20T08:51:53.348165+01:00","updated_at":"2025-12-20T08:55:56.999871+01:00","closed_at":"2025-12-20T08:55:56.999871+01:00","close_reason":"Implemented nested transient menus for column configuration with toggles, proper ordering, and customize integration"}
{"id":"bdel-ryp","title":"Implement edit status with completing-read","description":"Add 'e s' keybinding to change status:\n- Use completing-read with options: open, in_progress, blocked, closed\n- Current status as default\n- Commit via beads-rpc-update with :status\n- Refresh view after commit","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T12:59:15.21887+01:00","updated_at":"2025-12-17T13:08:02.846882+01:00","closed_at":"2025-12-17T13:08:02.846882+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-ryp","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:37.321263+01:00","created_by":"daemon"}]}
{"id":"bdel-s75","title":"Add reopen issue command","description":"Add command to reopen closed issues. Can use beads-rpc-update with status \"open\". Useful from detail view when viewing closed issues.","design":"**Behavior:**\n- Available in detail view when viewing closed issues\n- Binding: 'R' (reopen) or part of status edit flow\n- Optionally prompt for reason: \"Reason for reopening (RET to skip): \"\n- Sets status to \"open\", clears closed_at\n\n**CLI equivalent:** `bd reopen \u003cid\u003e --reason \"reason\"`\n\n**Note:** `bd reopen` is preferred over `bd update --status open` as it emits a Reopened event and clears closed_at timestamp.\n\n**Implementation:**\n- Check if RPC has dedicated \"reopen\" operation\n- If not, use update with status=\"open\" (less ideal but works)\n- Could also add to transient menu under status changes","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T19:22:18.650662+01:00","updated_at":"2025-12-17T21:15:59.231641+01:00","closed_at":"2025-12-17T21:15:59.231641+01:00","close_reason":"Implemented with R keybinding, uses beads-rpc-update with status open"}
{"id":"bdel-sir","title":"Implement edit title via minibuffer","description":"Add 'e t' keybinding to edit title:\n- Use read-string with current title as default\n- Commit immediately via beads-rpc-update with :title\n- Refresh view after commit\n- Works from both list and detail view","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T12:59:15.084159+01:00","updated_at":"2025-12-17T13:08:02.665283+01:00","closed_at":"2025-12-17T13:08:02.665283+01:00","close_reason":"Completed","dependencies":[{"issue_id":"bdel-sir","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:37.187926+01:00","created_by":"daemon"}]}
{"id":"bdel-sk1","title":"Implement labels management","description":"Add label editing commands:\n- 'e l a' - add label (read-string, commit via beads-rpc-label-add)\n- 'e l r' - remove label (completing-read from current labels, beads-rpc-label-remove)\n- Show current labels in prompt","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T12:59:15.814362+01:00","updated_at":"2025-12-17T13:16:33.032671+01:00","closed_at":"2025-12-17T13:16:33.032671+01:00","close_reason":"Implemented label management with 'e l a' (add) and 'e l r' (remove) keybindings","dependencies":[{"issue_id":"bdel-sk1","depends_on_id":"bdel-ab3","type":"parent-child","created_at":"2025-12-17T12:59:45.176077+01:00","created_by":"daemon"}]}
{"id":"bdel-t63","title":"Collapsible sections in detail view","description":"Add collapsible sections to the detail view for long-form fields (description, design, acceptance, notes). The metadata section at top should remain always visible. Users should be able to configure which sections start collapsed.","design":"## Research: Modern Emacs Help Buffer Approach\n\nEmacs 29+ help buffers (`C-h b` describe-bindings) use `outline-minor-mode` with clickable fold/unfold buttons. Here's exactly how they do it:\n\n```elisp\n;; From describe-bindings in help.el:\n(setq-local outline-regexp \".*:$\")\n(setq-local outline-heading-end-regexp \":\\n\")\n(setq-local outline-level (lambda () 1))\n(setq-local outline-minor-mode-cycle t\n            outline-minor-mode-highlight t\n            outline-minor-mode-use-buttons 'insert\n            outline-default-state 1)\n(outline-minor-mode 1)\n```\n\n## Key outline-minor-mode Variables\n\n| Variable | Purpose |\n|----------|---------|\n| `outline-regexp` | Regex to identify heading lines |\n| `outline-search-function` | **Alternative**: custom function to find headings (can use text properties!) |\n| `outline-level` | Function returning nesting level of current heading |\n| `outline-minor-mode-cycle` | Enable TAB/S-TAB to cycle visibility |\n| `outline-minor-mode-highlight` | Apply faces to headings |\n| `outline-minor-mode-use-buttons` | Show fold/unfold buttons: `nil`, `t`, `'insert`, `'in-margins` |\n| `outline-default-state` | Initial visibility: `nil` (all visible), number (collapse deeper levels) |\n\n## Button Display Options\n\n- `nil` - No buttons, just ellipsis \"...\" for hidden content\n- `t` - Clickable buttons displayed via overlay (doesn't modify buffer)\n- `'insert` - Buttons inserted into buffer text (modifies buffer, RET works)\n- `'in-margins` - Buttons in left margin (doesn't modify buffer)\n\nFor read-only special-mode buffers, `'insert` is fine since we rebuild on refresh anyway.\n\n## The Problem with outline-regexp\n\nOur detail buffer contains user-entered text (description, design notes) which can contain ANY characters including lines ending with colons. Using `outline-regexp` would incorrectly treat user text as headings.\n\n## Solution: outline-search-function with Text Properties\n\nSince we build the buffer from scratch, we have full control. Instead of regex matching, we:\n\n1. **Propertize headings** when rendering:\n```elisp\n(insert (propertize \"Description:\" \n                    'beads-outline-heading t\n                    'beads-heading-name 'description))\n```\n\n2. **Define custom search function**:\n```elisp\n(defun beads-detail--outline-search (bound move backward looking-at)\n  \"Find headings by text property instead of regex.\"\n  (if looking-at\n      (get-text-property (point) 'beads-outline-heading)\n    (let ((prop-match (if backward\n                          (text-property-search-backward 'beads-outline-heading t t)\n                        (text-property-search-forward 'beads-outline-heading t t))))\n      (when prop-match\n        (goto-char (prop-match-beginning prop-match))\n        (set-match-data (list (prop-match-beginning prop-match)\n                              (prop-match-end prop-match)))\n        t))))\n```\n\n3. **Configure outline-minor-mode**:\n```elisp\n(setq-local outline-search-function #'beads-detail--outline-search)\n(setq-local outline-level (lambda () 1))  ; All sections same level\n(setq-local outline-minor-mode-cycle t)\n(setq-local outline-minor-mode-use-buttons 'insert)\n(outline-minor-mode 1)\n```\n\n## Sections to Make Collapsible\n\nOnly long-form text fields, NOT the metadata header:\n- Description\n- Design Notes  \n- Acceptance Criteria\n- Notes\n\nThe top metadata (ID, status, priority, type, dates) should always be visible.\n\n## User Configuration\n\n```elisp\n(defcustom beads-detail-collapsed-sections '()\n  \"Sections collapsed by default in detail view.\nList of symbols: description, design, acceptance, notes.\nEmpty list means all sections expanded.\"\n  :type '(set (const :tag \"Description\" description)\n              (const :tag \"Design Notes\" design)\n              (const :tag \"Acceptance Criteria\" acceptance)\n              (const :tag \"Notes\" notes))\n  :group 'beads-detail)\n```\n\nAfter rendering, iterate through sections and collapse those in the list.\n\n## Implementation Steps\n\n1. Add `beads-detail-collapsed-sections` defcustom\n2. Modify `beads-detail--render` to propertize section headings\n3. Add `beads-detail--outline-search` function\n4. Configure outline-minor-mode in `beads-detail-mode`\n5. Add post-render step to collapse configured sections\n6. Test TAB cycling and button clicks\n\n## Navigation Affordances\n\nWith outline-minor-mode enabled, users get:\n- TAB on heading: cycle fold state (hidden → children → all)\n- S-TAB: cycle entire buffer\n- Clickable ▶/▼ buttons (with 'insert mode)\n- `outline-next-heading` / `outline-previous-heading` for navigation\n- Standard outline commands available\n\n## Future: Apply to Other Buffers\n\nThis pattern (text-property-based outline headings) can be reused for:\n- Hierarchy view (if we want collapsible subtrees beyond widget folding)\n- Any future buffer we build from scratch with sections\n\nThe key insight: when you control buffer construction, prefer text properties over regex for outline detection.","notes":"## Failed Implementation Attempt (2025-12-18)\n\n### What We Tried\n\n1. **outline-minor-mode with custom outline-search-function**\n   - Used text properties (`beads-outline-heading`) to mark headings\n   - Custom search function to find headings by property instead of regex\n   - Problems encountered:\n     - `outline-minor-mode-use-buttons` causes Emacs to hang\n     - `outline-heading-end-regexp \":\\n\"` matches user content (e.g., code blocks with `\":\\n\"`)\n     - `outline-hide-subtree` only hides children (lower levels), but all our headings are level 1\n     - `outline-hide-entry` worked partially but inconsistently\n\n2. **Custom invisible property approach**\n   - Replaced outline-minor-mode entirely\n   - Used `beads-detail--section-body-bounds` to find body region by text properties\n   - Toggle `invisible` property directly\n   - Problems:\n     - Finding heading on current line unreliable\n     - Property boundaries don't align with line boundaries as expected\n\n### Root Causes\n\n1. **outline-minor-mode assumes regex-based heading detection** - Even with `outline-search-function`, other parts of outline (like `outline-heading-end-regexp`) still use regex matching which can match user content.\n\n2. **User content is unpredictable** - Design notes contain markdown, code blocks, etc. Any regex pattern will eventually match something in user content.\n\n3. **Text property boundaries are tricky** - The heading property needs to include the newline for outline to work, but this interacts poorly with line-based operations.\n\n### Possible Future Approaches\n\n1. **Use a unique prefix character** for headings that won't appear in user content (e.g., a zero-width space or special Unicode char), then use standard outline-regexp.\n\n2. **Implement folding from scratch** without outline-minor-mode - use overlays with `invisible` property, manage state ourselves.\n\n3. **Use widgets** like `tree-widget` or similar that have built-in folding support.\n\n4. **Defer to a later Emacs version** that may have better outline-search-function support.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T08:24:50.707055+01:00","updated_at":"2025-12-18T22:48:30.098584+01:00","closed_at":"2025-12-18T22:48:30.098588+01:00"}
{"id":"bdel-tv1","title":"Add stats display","description":"Display project statistics. Options: header line in list view, dedicated command, or transient menu section. RPC exists (beads-rpc-stats).","design":"**What bd stats shows:**\n```\nTotal Issues:      53\nOpen:              19\nIn Progress:       0\nClosed:            34\nBlocked:           7\nReady:             12\nAvg Lead Time:     0.6 hours\n```\n\n**Implementation options:**\n1. **Header line in list view** - Show counts in header: \"53 issues (19 open, 7 blocked, 12 ready)\"\n2. **Dedicated command** - `M-x beads-stats` opens temp buffer with full stats\n3. **Transient menu section** - Display stats at top of `?` menu\n\n**Recommendation:** Option 1 (header line) for quick glance, plus Option 2 for full details.\n\n**RPC:** `beads-rpc-stats` already exists, returns JSON with all counts.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T19:22:18.805941+01:00","updated_at":"2025-12-18T07:25:05.59382+01:00","closed_at":"2025-12-18T07:25:05.59382+01:00","close_reason":"Implemented header line stats in list view, beads-stats command, S keybinding, and transient menu entries"}
{"id":"bdel-uxi","title":"Implement transient menus","description":"Create beads-transient.el with transient.el menus for view switching, filtering, and actions. Dynamic descriptions showing current state. See docs/emacs-ui.md Section 6.","notes":"Keybindings: ? and C-c m should both show the transient menu","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T08:06:09.903018+01:00","updated_at":"2025-12-17T09:10:24.173244+01:00","closed_at":"2025-12-17T09:10:24.173244+01:00","close_reason":"Implemented beads-transient.el with main menu, placeholder commands, and keybindings","dependencies":[{"issue_id":"bdel-uxi","depends_on_id":"bdel-5w1","type":"parent-child","created_at":"2025-12-17T08:06:21.713727+01:00","created_by":"daemon"},{"issue_id":"bdel-uxi","depends_on_id":"bdel-aw7","type":"blocks","created_at":"2025-12-17T08:06:31.873138+01:00","created_by":"daemon"}]}
{"id":"bdel-v3z","title":"Publish beads.el to MELPA","description":"Submit beads.el package to MELPA for distribution. This makes the package easily installable via package.el.","design":"**Prerequisites:**\n- Package header conventions (done: beads.el has proper headers)\n- Single entry point file or clear autoloads\n- README with installation/usage instructions\n- License file (GPL-compatible)\n\n**MELPA submission steps:**\n1. Fork https://github.com/melpa/melpa\n2. Create recipe file in `recipes/beads`:\n   ```elisp\n   (beads :fetcher github\n          :repo \"ChristianTietze/beads.el\"\n          :files (\"lisp/*.el\"))\n   ```\n3. Test locally with `make recipes/beads`\n4. Submit PR to melpa/melpa\n\n**Alternative:** NonGNU ELPA (requires FSF-compatible contributor agreement)\n\n**Checklist before submission:**\n- [ ] Verify all files have proper headers\n- [ ] Ensure autoloads work correctly\n- [ ] Test fresh install from git\n- [ ] Update README with MELPA badge/instructions","status":"in_progress","priority":3,"issue_type":"task","created_at":"2025-12-20T13:48:54.688368+01:00","updated_at":"2025-12-20T14:46:31.391776+01:00"}
{"id":"bdel-wqc","title":"Bulk operations in list view","description":"Add ability to mark/select multiple issues and perform bulk operations (close, change status, add label, delete). Common pattern in Emacs: mark with 'm', unmark with 'u', execute with 'x'.","design":"**Pattern:** Follow dired/ibuffer marking convention\n\n**Bindings:**\n- `m` - Mark issue at point\n- `u` - Unmark issue at point\n- `U` - Unmark all\n- `t` - Toggle marks\n- `% m` - Mark by regexp (on title)\n\n**Bulk operations (on marked issues):**\n- `x` or `B c` - Bulk close\n- `B s` - Bulk set status\n- `B p` - Bulk set priority\n- `B l` - Bulk add label\n- `B D` - Bulk delete (with yes-or-no-p)\n\n**Implementation:**\n- Add `beads-list--marked` buffer-local variable (list of IDs)\n- Display mark indicator in first column (e.g., `*`)\n- Bulk operations iterate over marked, call RPC for each\n- Show progress: \"Closing 3 issues...\"\n\n**Reference:** Similar to `dired-do-*` commands, `ibuffer-do-*`","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T19:22:42.400434+01:00","updated_at":"2025-12-20T09:35:53.02902+01:00","closed_at":"2025-12-20T09:35:53.02902+01:00","close_reason":"Implemented dired-style marking and bulk operations: mark column, m/u/U/t marking commands, % m and * m for regexp, * * for filtered view, and B s/p/c/D for bulk status/priority/close/delete"}
{"id":"bdel-xkf","title":"Implement preview mode (quicklook)","description":"Create beads-preview.el minor mode for automatic preview updates as selection changes. Uses post-command-hook with idle timer debouncing, buffer pooling, deduplication. See docs/emacs-ui.md Section 3.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T08:06:09.663679+01:00","updated_at":"2025-12-17T09:22:23.873517+01:00","closed_at":"2025-12-17T09:22:23.873517+01:00","close_reason":"Implemented beads-preview.el with quicklook functionality","dependencies":[{"issue_id":"bdel-xkf","depends_on_id":"bdel-5w1","type":"parent-child","created_at":"2025-12-17T08:06:21.538561+01:00","created_by":"daemon"},{"issue_id":"bdel-xkf","depends_on_id":"bdel-ijt","type":"blocks","created_at":"2025-12-17T08:06:31.792643+01:00","created_by":"daemon"}]}
{"id":"bdel-xoe","title":"Add undo/redo keybindings and menu entries","description":"Add keybindings and transient menu entries:\n\nKeybindings:\n- `u` in beads-list-mode-map → beads-undo\n- `u` in beads-detail-mode-map → beads-undo\n- `U` in both → beads-redo\n\nTransient menus:\n- Add \"Undo\" section to beads-list-menu and beads-detail-menu\n- Show undo/redo commands\n\nUpdate hints in beads.el to mention `u` for undo.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T15:01:31.743985+01:00","updated_at":"2025-12-17T15:01:31.743985+01:00","dependencies":[{"issue_id":"bdel-xoe","depends_on_id":"bdel-dyk","type":"parent-child","created_at":"2025-12-17T15:01:46.560075+01:00","created_by":"daemon"},{"issue_id":"bdel-xoe","depends_on_id":"bdel-0kf","type":"blocks","created_at":"2025-12-17T15:01:59.412194+01:00","created_by":"daemon"}]}
{"id":"bdel-y1k","title":"Integrate undo with beads-list.el (list view edits)","description":"Add undo recording to list view inline edits:\n\n- beads-list-edit-title\n- beads-list-edit-status\n- beads-list-edit-priority\n- beads-list-edit-type\n- beads-list-edit-description\n\nSame pattern as detail view - record before RPC call.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-17T15:01:31.55886+01:00","updated_at":"2025-12-17T15:01:31.55886+01:00","dependencies":[{"issue_id":"bdel-y1k","depends_on_id":"bdel-dyk","type":"parent-child","created_at":"2025-12-17T15:01:46.404285+01:00","created_by":"daemon"},{"issue_id":"bdel-y1k","depends_on_id":"bdel-0kf","type":"blocks","created_at":"2025-12-17T15:01:59.258086+01:00","created_by":"daemon"}]}
{"id":"bdel-ydh","title":"Form editor: C-c C-c / C-c C-k don't work inside text fields","description":"The save (C-c C-c) and cancel (C-c C-k) keybindings shown at the top of the form editor only work when point is outside text fields. When editing inside an editable-field or text widget, these bindings don't trigger.\n\nThis is likely because widget keymaps override the mode keymap. Need to extend the widget-specific keymaps (widget-field-keymap, widget-text-keymap) or use a different binding strategy.","design":"**Investigation needed**:\n- Check `widget-field-keymap` and `widget-text-keymap` \n- See how Custom-mode handles this (does it have the same issue?)\n- Options:\n  1. Add bindings to widget keymaps via `:keymap` property on widget creation\n  2. Use `define-key` on the widget-specific keymaps after widget-setup\n  3. Use a minor mode that takes precedence","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T18:33:21.379699+01:00","updated_at":"2025-12-17T18:38:55.810674+01:00","closed_at":"2025-12-17T18:38:55.810674+01:00","close_reason":"Fixed by passing custom keymaps with C-c bindings to widgets via :keymap property"}
